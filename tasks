Техническое задание

Описание функциональности
Страницы приложения
Приложение состоит из нескольких страниц:
 Main (/),
  Sign In (/login),
  MyList (/mylist),
  Film (/films/:id), Add review (/films/:id/review), Player (/player/:id).

Страницы MyList, Add review доступны только авторизованным пользователям.
Если пользователь не авторизован, то при переходе к этим страницам выполняется
редирект на страницу Sign In.
Если пользователь не авторизирован, то при попытке перехода к приватной
странице выполняется редирект на страницу «Sign In» (/login).
В правом углу шапки отображается аватар пользователя (если пользователь авторизован)
или ссылка «Sign In» (если пользователь не авторизован).
Клик по аватарке пользователя выполняет переход на страницу MyList (/mylist).

Главная страница
На главной странице представлены жанры, превью фильмов.
Страница с детальным описанием фильма доступна всем пользователям.
В шапке страницы отображается постер и обложка промо-фильма.
Промо-фильм можно сразу посмотреть, нажав кнопку «Play» или добавить в список «My List».
Получение промо-фильма для главной страницы выполняется отдельным запросом к серверу
(смотрите «Взаимодействие с сервером»).


Вкладки на странице описания фильма

Overview. Общая информация о фильме:
Описание фильма.
Режиссёр.
Список актёров.
Details. Расширенная информация:
Режиссёр.
Актёрский состав.
Продолжительность (часы, минуты).
Жанр.
Год выхода на экраны.
Reviews. Список отзывов пользователей.

Отзывы
Каждый отзыв содержит:
Текст отзыва.
Оценка пользователя.
Имя пользователя.
Дата отзыва в формате: Месяц (полное название) день, год. Например: December 24, 2018.
Добавление нового отзыва выполняется по кнопке «Add review».

Форма отправки отзыва
При нажатии на кнопку «Add review» выполняется переход на
страницу Add review (/films/:id/review).
Страница доступна только авторизованным пользователям.
Неавторизованные пользователи перенаправляются на страницу Sign In.
Пользователь выставляет оценку фильму от 1 до 5.
Оценка выставляется путём выделения определённого количества звёзд.
Текст отзыва должен быть не меньше 50 и не больше 400 символов.
Пока пользователь не поставил оценку и не ввел допустимый объём текста,
кнопка отправки отзыва не активна.
При нажатии кнопки «Post» и отправки данных форма должна блокироваться.
Разблокировка формы происходит в случае успешной отправки или при возникновении ошибки.
В случае успешной отправки формы пользователь перенаправляется в карточку текущего фильма.
В случае возникновения ошибки следует уведомить пользователя.
Способ отображения ошибки остаётся на усмотрение разработчика.


Страница MyList
Страница содержит информацию о фильмах, добавленных в список «К просмотру».
Добавление в список «К просмотру» осуществляется при нажатии на кнопку
«+ MyList» на странице «Film» и на главной странице для промо-фильма.
Страница «MyList» доступна только авторизованным пользователям.
Неавторизованные пользователи перенаправляются на страницу «Sign In».
Клик по карточке фильма (изображение, заголовок) выполняет переход
на страницу «Film» с детальным описанием фильма.

Страница Sign In
Страница «Sign in» доступна по адресу /login.
Для входа в сервис пользователь вводит логин (email) и пароль.
Поскольку у сервиса отсутствует возможность регистрации, логин и пароль могут быть любыми.
В поле «логин» должен вводиться корректный email.
Страница доступна только неавторизованным пользователям.
Авторизованных пользователей перенаправляет на главную страницу.
Информация об ошибках выводится в блок ошибок.

Просмотр фильмов
При нажатии на кнопку «Play» отрисовывается плеер и начинается показ выбранного фильма.
Функциональность плеера:
«Play/Pause». Запуск/остановка видео.
«Fullscreen». Перевод в полноэкранный режим.
«Time elapsed». Оставшееся время.
«Exit». Остановка просмотра. Плеер скрывается.
Плеер реализуется с помощью <video>.

Взаимодействие с сервером
В случае недоступности сервера отображается информационное сообщение.
Дизайн сообщения остаётся на усмотрение разработчика.


CommentPost
{
  "rating": 8,
  "comment": "Discerning travellers and Wes Anderson fans will luxuriate in the glorious Mittel-European kitsch of one of the director's funniest and most exquisitely designed movies in years."
}
User
{
  "email": "Oliver.conner@gmail.com",
  "password": "12345678"
}
AuthInfo
{
  "id": 1,
  "email": "Oliver.conner@gmail.com",
  "name": "Oliver.conner",
  "avatar_url": "img/1.png"
}
Маршруты

GET /favorite
Получение списка избранных фильмов.

Коды ответов:
200 ОК
401 Unauthorized (в случае если не пройдена авторизация)
Пример:

Request:
URL: GET /favorite
Response:
Status: 200 OK
Body: массив, содержащий структуры типа Film


POST /favorite/: film_id/: status
Изменение статуса избранного у фильма. В теле ответа приходят данные фильма с актуальным состоянием поля is_favorite.

Параметры:

:film_id — ID фильма, который нужно убрать/добавить в избранное
:status — значения могут быть 1 или 0. 1 добавляет фильм в избранное, 0 удаляет
Коды ответов:

200 ОК
401 Unauthorized (в случае если не пройдена авторизация)
Пример:

Request:
URL: GET /favorite/42/1
Response:
Status: 200 OK
Body: структура Film с актуальным состоянием поля is_favorite


GET /comments/: film_id
Получить список комментариев для фильма по его id.

Коды ответов:
200 ОК
400 Bad request
Пример:

Request:
URL: GET /comments/42
Response:
Status: 200 OK
Body: массив, содержащий структуры типа CommentGet


POST /comments/: film_id
Отправить новый комментарий к фильму по его id.

Коды ответов:
200 ОК
400 Bad request
401 Unauthorized (в случае если не пройдена авторизация)
Пример:

Request:
URL: POST /comments/42
Body: структура CommentPost
Response:
Status: 200 OK
Body: массив, содержащий структуры типа CommentGet для конкретного фильма


POST /login
Авторизация пользователя на сервере. В случае успешного запроса в куку записывается токен, по которому в дальнейшем происходит авторизация. Если авторазация на сервере не проходит, то возвращается 401 ошибка при запросах на приватные части сайта.

Коды ответов:
200 ОК
400 Bad request
Пример:

Request:
URL: POST /login
Body: структура User
Response:
Status: 200 OK
Body: структура AuthInfo


GET /login
Проверка статуса авторизации пользователя.

Коды ответов:
200 ОК
401 Unauthorized (в случае если не пройдена авторизация)
Пример:

Request:

URL: GET /login
Response:

Status: 200 OK
Body: структура AuthInfo
Коды ответов:

200 ОК
401 Unauthorized (в случае если не пройдена авторизация).

